## 一、前置知识：

#### （1）背景介绍：

Nim游戏是博弈论中最经典的模型（之一），它又有着十分简单的规则和无比优美的结论 Nim游戏是组合游戏(Combinatorial Games)的一种，准确来说，属于“Impartial Combinatorial Games”（以下简称ICG）。

#### （2）游戏规则：

```
整体：1、有两名选手；2、两名选手交替对游戏进行移动(move)，每次一步，选手可以在（一般而言）有限的合
法移动集合中任选一种进行移动；3、对于游戏的任何一种可能的局面，合法的移动集合只取决于这个局面本身；
4、如果轮到某名选手移动，且这个局面的合法的移动集合为空（也就是说此时无法进行移动），则这名选手负。
5、根据这个定义，很多日常的游戏并非ICG。例如象棋就不满足条件3，因为红方只能移动红子，黑方只能移动黑子，
合法的移动集合取决于轮到哪名选手操作。
```

```
通常的Nim游戏：
有若干堆石子，每堆石子的数量都是有限的，合法的移动是“选择一堆石子并拿走若干颗（不能不拿）”，如果轮到某个人时所有的石子堆都已经被拿空了，则判负（因为他此刻没有任何合法的移动）。
```

#### （3）异或运算是具有消去律，即：

a^b=b^c	可以推出	a=c



## 二、解法：

P-position先手必败，N-position先手必胜。（这个先手是指这一步轮到谁下）

（1）全0,先手败。

（2）仅剩下一堆石头，先手全拿完，先手胜。

（3）剩下两堆石头，如果两堆石头数量相等，先手拿了之后后手在另一堆复制先手的策略，这样先手必败。

但如果两堆石头数量不等，先手可以直接拿到两堆石头数量相等，这样先手必胜。

（4）但是三堆以上就很难这样分析了。



## 三、结论：

(Bouton's Theorem)对于一个Nim游戏的局面(a1,a2,...,an)，它是P-position当且仅当a1^a2^...^an=0，其中^表示异或(xor)运算。

即当且仅当a1^a2^...^an=0时先手必败



## 四、结论的证明：

（1）全0的最终状态是先手必败。



（2）某个被该结论判定为先手必败的局面的下一步是一定不是先手必败（而是先手必胜）。（任意）

（这样其实胜利者是同一个人，第一步的先手是第二步的后手）

```
若第一步是 a1^a2^...^an == 0。
需要证明下一步:	a1^a2...^ai' ^...^an ==0是不可能的。
反证法： 
若成立，则：	a1^a2...^ai'^...^an==a1^a2^...^ai^...^an。
			由于有消去律，则：ai'=ai,这显然不行。
```



（3）某个被该结论判定为先手必胜的局面的下一步可以是一定是先手必败。（存在）

```
若第一步是 a1^a2^...^an== k,
需要证明存在 a1^a2^...^ai'^...^an==0。
一定存在某个ai，它的二进制表示在k的最高位上是1（否则k的最高位那个1是怎么得到的）。这时ai^k<ai一定成立。则我们可以将ai改变成ai'=ai^k，此时a1^a2^...^ai'^...^an=a1^a2^...^an^k=0。
```



